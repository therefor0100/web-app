<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <style>
      *{margin:0;padding: 0}
      .gamebox{width:300px;height:300px;margin: 0 auto;overflow:hidden;}
      .box{width:100px;height:100px;float: left;background-color: pink;line-height: 100px;font-size: 20px;text-align: center;}
      .btn{width:100px;height:100px;float: left;background-color: yellow;line-height: 100px;font-size: 20px;text-align: center;}
      .btn:hover{background-color: deepskyblue;cursor: pointer;}
      .gamebox .touch{background-color: darkred;}
    </style>
  </head>
  <body>
    <div class="gamebox">
      <span class="box">1</span>
      <span class="box">2</span>
      <span class="box">3</span>
      <span class="box">大奖呦</span>
      <span class="btn">^_^抽奖</span>
      <span class="box">4</span>
      <span class="box">7</span>
      <span class="box">6</span>
      <span class="box">5</span>
    </div>
    <script src="lib2/zepto.min.js" charset="utf-8"></script>
    <script type="text/javascript">
      $(".btn").click(function(){
        var $gamebox = $(".gamebox .box");
        var newArr = getNewarr($gamebox);
        console.log($gamebox)
        
        var win = getRandom();
        var speed = 50;
        var index = 0;
        //console.log(win);
        action();
        function action(){
          console.log(win);
          speed += 50;
          newArr.removeClass("touch");
          newArr.eq(index).addClass("touch");
          index++;
          var timer =  setTimeout(function(){

            if(index > 7){
              index = 0;
            }
            if(speed > 500){
              speed = 500;
            }
            if(index == win){

              if(speed >= 500){
                //clearInterval(timer);
                if(win == 0){
                  alert("亲 恭喜你阳光普照！")
                }else{
                  alert("亲 恭喜你中了 " + win + " 奖~")
                }
              }else{
                action();
              }
            }else{
              action();
            }
          },speed)
        }
      })
      function getRandom(){
        return Math.floor(Math.random()*8);
      }
      function getNewarr(arr){
        var newArr = [];
        newArr[0] = arr[0];
        newArr[1] = arr[1];
        newArr[2] = arr[2];
        newArr[3] = arr[4];
        newArr[4] = arr[7];
        newArr[5] = arr[6];
        newArr[6] = arr[5];
        newArr[7] = arr[3];
        return $(newArr);
      }
    </script>
  </body>
</html>
